{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\micha\\\\Desktop\\\\zadanie-react\\\\front\\\\src\\\\pages\\\\order\\\\orderForm\\\\OrderForm.tsx\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { Form, Button } from \"react-bootstrap\";\nimport axios from \"axios\";\nimport { useAppDispatch, useAppSelector } from \"../../../redux/hooks\";\nimport { toast } from \"react-toastify\";\nimport { clearCart } from \"../../../redux/features/cart/cartSlice\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst OrderForm = () => {\n  _s();\n\n  const dispatch = useAppDispatch();\n  const {\n    register,\n    handleSubmit,\n    reset\n  } = useForm();\n  const [order, setOrder] = useState([]);\n  const cart = useAppSelector(state => state.cart);\n  const [isSuccessfullySubmitted, setIsSuccessfullySubmitted] = useState(false);\n  useEffect(() => {\n    const orderedItems = cart.map(book => {\n      return {\n        id: book.id,\n        quantity: 1\n      };\n    });\n    setOrder(orderedItems); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  useEffect(() => {\n    let submitSuccessfulTimer = setTimeout(() => setIsSuccessfullySubmitted(false), 3000);\n    return () => {\n      clearTimeout(submitSuccessfulTimer);\n    };\n  }, [isSuccessfullySubmitted]);\n\n  const onFormSubmit = data => {\n    if ((cart === null || cart === void 0 ? void 0 : cart.length) > 0) {\n      try {\n        axios.post(\"http://localhost:3001/api/order\", {\n          order: order,\n          first_name: data.first_name,\n          last_name: data.last_name,\n          city: data.city,\n          zip_code: data.zip_code\n        });\n        toast.success(\"You have successfully bought chosen books.\");\n        setIsSuccessfullySubmitted(true);\n        reset();\n        dispatch(clearCart());\n      } catch (error) {\n        toast.error(`Could not send data: ${error.message}`);\n      }\n    } else {\n      toast.warning(`Your cart is empty.`);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(Form, {\n    className: \"mt-5\",\n    onSubmit: handleSubmit(onFormSubmit),\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      className: \"mb-3\",\n      children: \"Submit your order\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n      className: \"mb-3\",\n      controlId: \"first_name\",\n      children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n        children: \"First name\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n        type: \"text\",\n        placeholder: \"Enter your first name\",\n        ...register(\"first_name\"),\n        minLength: 4,\n        required: true,\n        name: \"first_name\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n      className: \"mb-3\",\n      controlId: \"last_name\",\n      children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n        children: \"Last name\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n        type: \"text\",\n        placeholder: \"Enter your last name\",\n        ...register(\"last_name\"),\n        minLength: 5,\n        required: true,\n        name: \"last_name\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n      className: \"mb-3\",\n      controlId: \"city\",\n      children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n        children: \"City\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n        type: \"text\",\n        placeholder: \"Enter your city name\",\n        ...register(\"city\"),\n        required: true,\n        name: \"city\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n      className: \"mb-3\",\n      controlId: \"zip_code\",\n      children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n        children: \"ZIP\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n        type: \"text\",\n        placeholder: \"Enter ZIP code\",\n        ...register(\"zip_code\"),\n        required: true,\n        name: \"zip_code\",\n        pattern: \"[0-9]{2}-[0-9]{3}\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      variant: isSuccessfullySubmitted ? \"success\" : \"primary\",\n      type: \"submit\",\n      children: isSuccessfullySubmitted ? \"ORDERED SUCCESSFULLY\" : \"ORDER AND PAY\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n};\n\n_s(OrderForm, \"BvXh+WcNdOVC6ngm+fRqQm/2Xbw=\", false, function () {\n  return [useAppDispatch, useForm, useAppSelector];\n});\n\n_c = OrderForm;\nexport default OrderForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"OrderForm\");","map":{"version":3,"names":["useEffect","useState","useForm","Form","Button","axios","useAppDispatch","useAppSelector","toast","clearCart","OrderForm","dispatch","register","handleSubmit","reset","order","setOrder","cart","state","isSuccessfullySubmitted","setIsSuccessfullySubmitted","orderedItems","map","book","id","quantity","submitSuccessfulTimer","setTimeout","clearTimeout","onFormSubmit","data","length","post","first_name","last_name","city","zip_code","success","error","message","warning"],"sources":["C:/Users/micha/Desktop/zadanie-react/front/src/pages/order/orderForm/OrderForm.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { Form, Button } from \"react-bootstrap\";\nimport axios from \"axios\";\nimport { useAppDispatch, useAppSelector } from \"../../../redux/hooks\";\nimport { Book } from \"../../../redux/features/books/booksSlice\";\nimport { toast } from \"react-toastify\";\nimport { clearCart } from \"../../../redux/features/cart/cartSlice\";\n\nexport interface NewOrder {\n  order: Order[];\n  first_name: string;\n  last_name: string;\n  city: string;\n  zip_code: string;\n}\n\nexport interface Order {\n  id: number;\n  quantity: number;\n}\n\nconst OrderForm = () => {\n  const dispatch = useAppDispatch();\n  const { register, handleSubmit, reset } = useForm<NewOrder>();\n  const [order, setOrder] = useState<Order[]>([]);\n  const cart = useAppSelector((state) => state.cart);\n  const [isSuccessfullySubmitted, setIsSuccessfullySubmitted] =\n    useState<boolean>(false);\n\n  useEffect(() => {\n    const orderedItems: Order[] = cart.map((book: Book) => {\n      return {\n        id: book.id,\n        quantity: 1,\n      };\n    });\n    setOrder(orderedItems);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    let submitSuccessfulTimer = setTimeout(\n      () => setIsSuccessfullySubmitted(false),\n      3000\n    );\n    return () => {\n      clearTimeout(submitSuccessfulTimer);\n    };\n  }, [isSuccessfullySubmitted]);\n\n  const onFormSubmit = (data: NewOrder) => {\n    if (cart?.length > 0) {\n      try {\n        axios.post(\"http://localhost:3001/api/order\", {\n          order: order,\n          first_name: data.first_name,\n          last_name: data.last_name,\n          city: data.city,\n          zip_code: data.zip_code,\n        });\n        toast.success(\"You have successfully bought chosen books.\");\n        setIsSuccessfullySubmitted(true);\n        reset();\n        dispatch(clearCart());\n      } catch (error: any) {\n        toast.error(`Could not send data: ${error.message}`);\n      }\n    } else {\n      toast.warning(`Your cart is empty.`);\n    }\n  };\n\n  return (\n    <Form className=\"mt-5\" onSubmit={handleSubmit(onFormSubmit)}>\n      <h3 className=\"mb-3\">Submit your order</h3>\n      <Form.Group className=\"mb-3\" controlId=\"first_name\">\n        <Form.Label>First name</Form.Label>\n        <Form.Control\n          type=\"text\"\n          placeholder=\"Enter your first name\"\n          {...register(\"first_name\")}\n          minLength={4}\n          required\n          name=\"first_name\"\n        />\n      </Form.Group>\n      <Form.Group className=\"mb-3\" controlId=\"last_name\">\n        <Form.Label>Last name</Form.Label>\n        <Form.Control\n          type=\"text\"\n          placeholder=\"Enter your last name\"\n          {...register(\"last_name\")}\n          minLength={5}\n          required\n          name=\"last_name\"\n        />\n      </Form.Group>\n      <Form.Group className=\"mb-3\" controlId=\"city\">\n        <Form.Label>City</Form.Label>\n        <Form.Control\n          type=\"text\"\n          placeholder=\"Enter your city name\"\n          {...register(\"city\")}\n          required\n          name=\"city\"\n        />\n      </Form.Group>\n      <Form.Group className=\"mb-3\" controlId=\"zip_code\">\n        <Form.Label>ZIP</Form.Label>\n        <Form.Control\n          type=\"text\"\n          placeholder=\"Enter ZIP code\"\n          {...register(\"zip_code\")}\n          required\n          name=\"zip_code\"\n          pattern=\"[0-9]{2}-[0-9]{3}\"\n        />\n      </Form.Group>\n\n      <Button\n        variant={isSuccessfullySubmitted ? \"success\" : \"primary\"}\n        type=\"submit\"\n      >\n        {isSuccessfullySubmitted ? \"ORDERED SUCCESSFULLY\" : \"ORDER AND PAY\"}\n      </Button>\n    </Form>\n  );\n};\n\nexport default OrderForm;\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}